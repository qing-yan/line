import{aP as u,F as c,P as i,Q as m,S as t,ac as n,ad as r,ae as a,a8 as p,Y as V,c as g,u as D}from"./framework-270ea3de.js";import{E as b}from"./app-56f1830e.js";const v={data(){return{table_name:"",cols:"",excelData:"",result:""}},created(){},methods:{decode(){this.excelData[this.excelData.length-1]===`
`&&(this.excelData=this.excelData.substring(0,this.excelData.length-1)),this.excelData=this.excelData.replace(/^/gm,"('").replace(/$/gm,"'),").replaceAll("	","','"),this.result=`INSERT INTO ${this.table_name} (${this.cols}) VALUES ${this.excelData}`,this.copy()},copy(){navigator.clipboard.writeText(this.result).then(()=>{b({message:"复制成功",type:"success"})})}}};function y(d,l,_,I,e,x){const s=c("el-input"),h=c("el-button"),f=c("el-card");return i(),m(V,null,[t("div",null,[n(" INSERT INTO "),t("span",null,r(e.table_name),1),n(" ( "),t("span",null,r(e.cols),1),n(" ) VALUES ")]),t("div",null,[a(s,{modelValue:e.table_name,"onUpdate:modelValue":l[0]||(l[0]=o=>e.table_name=o),placeholder:"表名"},null,8,["modelValue"])]),t("div",null,[a(s,{modelValue:e.cols,"onUpdate:modelValue":l[1]||(l[1]=o=>e.cols=o),placeholder:"字段名，用逗号分隔"},null,8,["modelValue"])]),t("div",null,[a(s,{type:"textarea",rows:10,modelValue:e.excelData,"onUpdate:modelValue":l[2]||(l[2]=o=>e.excelData=o),placeholder:"excel数据"},null,8,["modelValue"])]),a(h,{type:"primary",onClick:x.decode,style:{"margin-top":"5px","margin-bottom":"5px"}},{default:p(()=>[n("解析并复制")]),_:1},8,["onClick"]),a(f,null,{default:p(()=>[n(r(e.result),1)]),_:1})],64)}const E=u(v,[["render",y],["__file","excel-import.vue"]]),N=g({__name:"excel-import.html",setup(d){return(l,_)=>(i(),m("div",null,[a(D(E))]))}}),C=u(N,[["__file","excel-import.html.vue"]]);export{C as default};
